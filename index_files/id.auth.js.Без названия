var $jscomp={scope:{},findInternal:function(a,d,b){a instanceof String&&(a=String(a));for(var c=a.length,e=0;e<c;e++){var f=a[e];if(d.call(b,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,d,b){if(b.get||b.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[d]=b.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,d,b,c){if(d){b=$jscomp.global;a=a.split(".");for(c=0;c<a.length-1;c++){var e=a[c];e in b||(b[e]={});b=b[e]}a=a[a.length-1];c=b[a];d=d(c);d!=c&&null!=d&&$jscomp.defineProperty(b,a,{configurable:!0,writable:!0,value:d})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,b){return $jscomp.findInternal(this,a,b).v}},"es6-impl","es3");
$(function(){var a=$("#modalAuth").find("form"),d=$("#modalAuthEmailField"),b=$("#modalAuthError"),c=$("#modalAuthSubmit");a.riaForm({errorInput:!0,errorLabel:!0,errorClass:"m-error",errorMessage:!1,errorAlert:!0,alert:"#modalAuthError",alertLabel:"",loader:".l-modal__container .l-modal__loader",rules:{login:"empty",password:"empty"},alerts:{login:{empty:GLOBAL.locale.id.errors.emptylogin,not_exist:GLOBAL.locale.id.errors.wrong},password:{wrong:GLOBAL.locale.id.errors.wrong},secret:{secret:GLOBAL.locale.id.errors.confirm},
user:{banned:GLOBAL.locale.id.errors.block,deleted:GLOBAL.locale.id.errors.del,confirmationRequired:GLOBAL.locale.id.errors.confirmation}},successCallback:function(a,b){modalLayer.close({clearForm:!0,afterClose:function(){GLOBAL.events.trigger("login",a)}})},errorCallback:function(a){c.hide();a.user&&b.attr("user_id",a.user);a.errors&&"confirmationRequired"===a.errors.user&&setTimeout(function(){b.find(".m-email").text(d.val())},0);$("#modalAuthRecoveryLink").addClass("m-prime");c.show().find(".form__btn").attr("disabled",
!1)}});$(".modal__social a").each(function(){$(this).riaAuthSocial({provider:$(this).data("provider")})});a.on("input change paste",function(){a[0].checkValidity()?(b.hide(),c.show()):c.hide()});d.on("blur",function(){this.checkValidity()||b.show().html(GLOBAL.locale.id.errors.wronglogin)});$("body").on("click","#modalUserRemindLetter",function(){$.ajax({url:"/services/id/email/restore_account/",type:"post",dataType:"json",data:{user_id:b.attr("user_id")},success:function(a){"success"===a.status?
b.html(GLOBAL.locale.id.errors.send):b.html(GLOBAL.locale.id.errors.notsend)}})});"?restore_account"==location.search&&setTimeout(function(){modalLayer.open({customTitle:GLOBAL.locale.id.restoreaccount.success,customContent:""})},100);"?restore_account_error"==location.search&&setTimeout(function(){modalLayer.open({customTitle:GLOBAL.locale.id.restoreaccount.error,customContent:""})},100);GLOBAL.events.subscribe("login",function(a){$(".header__menu-login").removeAttr("data-modal-open").attr("href",
"/id/profile/");GLOBAL.auth.status="ok";GLOBAL.auth.moderator=a.user.moderator;GLOBAL.user=a.user;GLOBAL.csrf_token=a.user.csrf_token;$('input[name="csrf_token"]').val(GLOBAL.csrf_token);ria_sock&&ria_sock.send({type:"user_login",message:{user_id:GLOBAL.user.id||null}});ria_chat&&ria_chat.auth();$("body").addClass("m-auth")});GLOBAL.events.subscribe("logout",function(){ria_sock&&ria_sock.send({type:"user_logout",message:{user_id:GLOBAL.user.id||null}})})});
