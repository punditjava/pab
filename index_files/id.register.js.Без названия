var $jscomp={scope:{},findInternal:function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};
$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};
$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");
afterRegister=function(a){modalLayer.open("registration_user");$.extend({},GLOBAL.user,a.user);GLOBAL.csrf_token=a.user.csrf_token;var b=new Profile({csrf_token:GLOBAL.csrf_token});a.user.firstName&&$("#modalRegisterUser").find('input[name="firstName"]').val(a.user.firstName).focus();a.user.lastName&&$("#modalRegisterUser").find('input[name="lastName"]').val(a.user.lastName).focus();(a.user.lastName||a.user.firstName)&&$("#modalRegisterUser").find("form").trigger("change");a.user.picture&&$("#registerUserPhoto").attr("src",
a.user.picture);$.fn.fileupload instanceof Function&&$("#registerUserPhotoUpload").fileupload({type:"post",dataType:"json",url:b.actions.update_avatar,formData:{csrf_token:b.csrf_token},done:function(a,b){$("#registerUserPhoto").attr("src",b.result.user.picture)}})};
$(function(){var a=$("#modalRegister").find("form"),b=$("#modalRegisterEmail"),c=$("#modalRegisterPassword"),d=$("#modalRegisterError"),e=$("#modalRegisterSubmit");a.riaForm({errorInput:!0,errorLabel:!0,errorClass:"m-error",errorMessage:!1,errorAlert:!0,alert:"#modalRegisterError",alertLabel:"",loader:".l-modal__container .l-modal__loader",rules:{login:"email",password:"empty",confirm:"checked"},alerts:{login:{empty:GLOBAL.locale.id.errors.emptylogin,exist:GLOBAL.locale.id.errors.emailexist,email:GLOBAL.locale.id.errors.wronglogin},
password:{empty:GLOBAL.locale.id.errors.password,similar:GLOBAL.locale.id.errors.passwordnotsimilar},captcha:{error:GLOBAL.locale.id.errors.global},email:{"error.2":GLOBAL.locale.id.errors.emailwhitelist}},successCallback:function(a,e){"success"===a.status&&($("#alertAfterRegister").removeClass("m-hidden").find(".m-email").text(b.val()),afterRegister(a))},errorCallback:function(a){e.hide()}});a.on("input change paste keyup blur",function(){a[0].checkValidity()?e.find("button")[0].disabled=!1:e.find("button")[0].disabled=
!0});b.on("input change paste keyup",function(){this.checkValidity()?(d.hide(),e.show()):(d.show().toggleClass("m-error",!this.checkValidity()&&b.hasClass("m-dirty")).html(GLOBAL.locale.id.errors.wronglogin),e.hide())});c.on("input change paste keyup",function(){this.checkValidity()?(d.hide(),e.show()):(d.show().toggleClass("m-error",!this.checkValidity()&&c.hasClass("m-dirty")).html(GLOBAL.locale.id.register.password_length),e.hide())})});
$(function(){var a=$("#modalRegisterSocial").find("form"),b=$("#modalRegisterSocialError"),c=$("#modalRegisterSocialEmail"),d=$("#modalRegisterSocialSubmit");a.riaForm({errorInput:!0,errorLabel:!0,errorClass:"m-error",errorMessage:!1,errorAlert:!0,alert:"#modalRegisterSocialError",alertLabel:"",rules:{login:"empty",privacy:"empty"},alerts:{login:{empty:GLOBAL.locale.id.errors.wrongemail,wrong:GLOBAL.locale.id.errors.wronglogin},user:{banned:GLOBAL.locale.id.errors.block,deleted:GLOBAL.locale.id.errors.del,
confirmationRequired:GLOBAL.locale.id.errors.confirmation}},successCallback:function(a,b){modalLayer.close({formClear:"all",afterClose:function(){GLOBAL.events.trigger("login",a);afterRegister(a)}})},errorCallback:function(a){a&&a.user&&b.attr("user_id",a.user);a&&a.errors&&"confirmationRequired"===a.errors.user&&setTimeout(function(){b.find(".m-email").text(c.val())},0)}});a.on("input change paste keyup",function(){this.checkValidity()?(b.hide(),d.show()):d.hide()});c.on("blur",function(){this.checkValidity()||
b.show().html(GLOBAL.locale.id.errors.wronglogin)})});
$(function(){var a,b=$("#modalRegisterUser").find("form"),c=$("#modalRegisterUserError"),d=$("#modalRegisterUserSubmit"),e=d.find("button");b.on("submit",function(c){c.preventDefault();this.checkValidity()&&(a||(a=new Profile({csrf_token:GLOBAL.csrf_token})),e.prop("disabled",!0),a.updateField(b).done(function(a){e.prop("disabled",!1);a.errors?(a.errors.firstName&&b.find('input[name="firstName"]')[0].setCustomValidity("\u041d\u0435\u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0435 \u0438\u043c\u044f"),a.errors.lastName&&
b.find('input[name="lastName"]')[0].setCustomValidity("\u041d\u0435\u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0435 \u0438\u043c\u044f"),a.errors.moderation&&(b.find('input[name="firstName"]')[0].setCustomValidity("\u041d\u0435\u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0435 \u0438\u043c\u044f"),b.find('input[name="lastName"]')[0].setCustomValidity("\u041d\u0435\u0434\u043e\u043f\u0443\u0441\u0442\u0438\u043c\u043e\u0435 \u0438\u043c\u044f")),b.trigger("change"),b.find("input").each(function(){this.setCustomValidity("")})):
modalLayer.close()}))});b.on("input change paste keyup",function(){this.checkValidity()?(c.hide(),d.show()):(c.show(),d.hide())})});$(function(){$(".confirmEmail").on("click",function(a){a.preventDefault();var b=$(this);$.ajax({url:"/services/id/email/confirm_email/",data:{csrf_token:GLOBAL.csrf_token}}).done(function(){b.attr("disabled",!0).text("\u0421\u0441\u044b\u043b\u043a\u0430 \u043e\u0442\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0430")})})});
