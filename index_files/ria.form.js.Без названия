(function(c){c.fn.riaForm=function(a){a=c.extend({type:"post",dataType:"json",block:!0,loader:".loader",deleteData:!1,rules:!1,mixinData:!1,errorClass:"m-error",errorInput:!1,errorLabel:!1,errorMessage:!0,message:".message-error",messageConnector:"data-field",messages:!1,errorCallback:void 0,errorAlert:!1,alert:".message-alert",alerts:!1,alertCallback:void 0,submitCallback:void 0,successCallback:void 0,forceCallback:void 0},a||{});var d=c(this),l=c(a.loader,d),r=d.attr("action"),g=0,h={},f=function(b,
k){console.log(b,"  ",k);if(b&&k){var e;if(0<c('input[name="'+b+'"]',d).length)e=c('input[name="'+b+'"]',d);else if(0<c('textarea[name="'+b+'"]',d).length)e=c('textarea[name="'+b+'"]',d);else if(0<c('select[name="'+b+'"]',d).length)e=c('select[name="'+b+'"]',d);else return;a.errorInput&&e.addClass(a.errorClass);if(a.errorLabel){var f=c('label[for="'+e.attr("id")+'"]');0<f.length?f.addClass(a.errorClass):e.parent().get(0)&&"LABEL"==e.parent().get(0).tagName&&e.parent().addClass(a.errorClass)}a.errorMessage&&
(e=c(a.message+"["+a.messageConnector+'="'+b+'"]',d),0<e.length&&a.messages&&a.messages[b]&&e.empty().append(a.messages[b][k]).show())}},t=function(){for(key in a.rules){var b=c.type(a.rules[key]);if("object"===b)for(node in a.rules[key]){var d=key,e=a.rules[key][node];m(d,node,e)}if("array"===b)for(node in d=key,a.rules[key])e=a.rules[key][node],m(d,e);else m(key,a.rules[key])}return g},m=function(b,a,c){switch(a){case "function":c instanceof Function&&(c=c(d,b),0==c&&(g++,h[b]="function",f(b,"function")));
break;case "empty":1==u(b)&&(g++,h[b]="empty");break;case "email":1==v(b)&&(g++,h[b]="email");break;case "number":1==w(b)&&(g++,h[b]="number")}a instanceof Function&&(c=a(d,b),0==c&&(g++,h[b]="function",f(b,"function")))},u=function(b){if(0<c('input[name="'+b+'"][type="checkbox"], input[name="'+b+'"][type="radio"]',d).length){var a=c('input[name="'+b+'"]',d).is(":checked");if(0==a)return f(b,"empty"),!0}if(0<c('input[name="'+b+'"][type="file"]',d).length){var a=window.File&&window.FileReader&&window.FileList&&
window.Blob?!0:!1,e=c('input[name="'+b+'"][type="file"]',d),a=a&&e[0].files[0]?e[0].files[0].name:e.val().replace("C:\\fakepath\\","");if(0==a.length)return f(b,"empty"),!0}return 0<c('input[name="'+b+'"]',d).length&&(a=c('input[name="'+b+'"]',d).val(),0==a.length)||0<c('textarea[name="'+b+'"]',d).length&&(a=c('textarea[name="'+b+'"]',d).val(),0==a.length)||0<c('select[name="'+b+'"]',d).length&&(a=c('select[name="'+b+'"]',d).val(),0==a.length)?(f(b,"empty"),!0):!1},v=function(b){if(0<c('input[name="'+
b+'"]',d).length){var a=c('input[name="'+b+'"]',d).val();reg=/[0-9a-z_\-]+@[0-9a-z\-_^.]+\.[a-z]{2,10}/i;if(reg.test(a))return!1;f(b,"email");return!0}if(0<c('textarea[name="'+b+'"]',d).length){a=c('textarea[name="'+b+'"]',d).val();reg=/[0-9a-z_\-]+@[0-9a-z\-_^.]+\.[a-z]{2,10}/i;if(reg.test(a))return!1;f(b,"email");return!0}if(0<c('select[name="'+b+'"]',d).length){a=c('select[name="'+b+'"]',d).val();reg=/[0-9a-z_\-]+@[0-9a-z\-_^.]+\.[a-z]{2,10}/i;if(reg.test(a))return!1;f(b,"email");return!0}},w=
function(b){if(0<c('input[name="'+b+'"]',d).length){var a=c('input[name="'+b+'"]',d).val();reg=/[0-9]/i;if(reg.test(a))return!1;f(b,"number");return!0}if(0<c('textarea[name="'+b+'"]',d).length){a=c('textarea[name="'+b+'"]',d).val();reg=/[0-9]/i;if(reg.test(a))return!1;f(b,"number");return!0}if(0<c('select[name="'+b+'"]',d).length){a=c('select[name="'+b+'"]',d).val();reg=/[0-9]/i;if(reg.test(a))return!1;f(b,"number");return!0}},p=function(){g=0;h={};a.errorInput&&(c("input",d).removeClass(a.errorClass),
c("textarea",d).removeClass(a.errorClass),c("select",d).removeClass(a.errorClass));a.errorLabel&&c("label",d).removeClass(a.errorClass);a.errorMessage&&c(a.message,d).hide()},n=function(b){a.errorInput&&b.removeClass(a.errorClass);if(a.errorLabel){var f=c('label[for="'+b.attr("id")+'"]');0<f.length?f.removeClass(a.errorClass):"LABEL"==b.parent().get(0).tagName&&b.parent().removeClass(a.errorClass)}a.errorMessage&&c(a.message+"["+a.messageConnector+'="'+b.attr("name")+'"]',d).fadeOut(100)},x=function(){var a=
d.serializeArray(),c={};for(key in a)c[a[key].name]=a[key].value;return c},y=function(b){if(!(!a.convertData instanceof Object)){for(convertKey in a.convertData)if(a.convertData[convertKey]instanceof Function){var c=a.convertData[convertKey](b[convertKey]);b[convertKey]=c}return b}},z=function(b){for(key in a.deleteData)delete b[a.deleteData[key]];return b},q=function(){var b,g=0;b=x();a.convertData instanceof Object&&(g=c.map(a.convertData,function(a,b){return b}).length,0<g&&(b=y(b)));a.mixinData instanceof
Function&&(mixinData=a.mixinData(),b=c.extend(b,mixinData||{}));a.deleteData instanceof Object&&(b=z(b));a.submitCallback instanceof Function&&a.submitCallback(d,b);c.ajax({type:a.type,url:r,dataType:a.dataType,data:b,xhrFields:{withCredentials:!0},error:function(b){l.fadeOut();a.errorCallback instanceof Function&&a.errorCallback(b)},success:function(b){l.fadeOut();1==a.block&&(c('input[type="submit"]',d).removeAttr("disabled"),c("button",d).removeAttr("disabled"));if(b.error||b.status&&"error"==
b.status.toLowerCase()){var e=b.errors;for(key in e)f(key,e[key]);if(a.alerts&&a.errorAlert){var e=b.errors,g=0;for(key in e){if(a.alerts[key]&&1>g){var h=c(a.alert,d),k=e[key];h.empty().append(a.alerts[key][k]).show();a.alertCallback instanceof Function&&a.alertCallback(e)}g++}}a.errorCallback instanceof Function&&a.errorCallback(b)}else a.successCallback instanceof Function&&a.successCallback(b,d);a.forceCallback instanceof Function&&a.forceCallback(b,d)}})};d.bind("hideErrors",function(){p()});
d.off("submit").on("submit",function(b){b.preventDefault();p();c(a.alert,d).hide();g=t();0<g&&a.errorCallback instanceof Function&&a.errorCallback(h);0==g&&(l.fadeIn(),1==a.block&&(c('input[type="submit"]',d).attr("disabled","disabled"),c("button",d).attr("disabled","disabled")),c('input[name="g-recaptcha-response"]',d).length?(b=Date.now(),window["grecaptchaForm"+b]=c.proxy(function(){grecaptcha.execute(GLOBAL.locale.grecaptcha.site_key).then(function(a){c("input[name=g-recaptcha-response]",d).val(a);
q()})},this),loadJS("https://www.google.com/recaptcha/api.js?render="+GLOBAL.locale.grecaptcha.site_key+"&onload=grecaptchaForm"+b)):q())});c("input, textarea",d).on("keydown",function(){n(c(this))});c('input[type="checkbox"], select',d).on("change",function(){n(c(this))});c('input[type="radio"]',d).on("change",function(){c('input[type="radio"][name="'+c(this).attr("name")+'"]',d).each(function(){n(c(this))})});return"1.5"}})(jQuery);
