var ria_layout_manager={init:function(){var a=this;console.log("ria_layout_manager >>> inited");a.minHeightViewWidgets=100;a.headerToSmall=300;a.widgetsSize=!1;a.stickedOn=$("#body").data("header-sticked-on")&&0<$("#header").length?!0:!1;a.isMobile=ria&&ria.mobileBrowser?ria.mobileBrowser():!1;a.notPullToReload="page-nopulltoreload";a._state={lenta:!1,chat:!1,live:!1,notPull:!1};a.mod={hSticked:"m-header-sticked",hSmall:"m-header-small",hBrand:"m-header-brand",lenta:"m-widget-lenta",chat:"m-widget-chat",
live:"m-widget-live"};a.button={lenta:"js__toggle-lenta",chat:"js__toggle-chat",live:"js__toggle-live",all:"js__widgets-close"};window.history&&history.pushState&&history.replaceState&&a.historyHandlers();$(window).on("scroll resize",function(){a.stickedOn&&a.headerStatesSwitching();a.setWidgetsSize()});a.widgetsManager();$(window).scroll();$("#body").addClass("m-header-ready")},historyHandlers:function(){var a=this;a.fromHistory=!1;a.disablePopstate=!1;$("body").bind("widget",function(b,d,c){"lenta"!=
d||a.fromHistory||(1==c?history.pushState({lenta:!0},null,location.href):(a.disablePopstate=!0,history.back()));"chat"!=d||a.fromHistory||(1==c?history.pushState({chat:!0},null,location.href):(a.disablePopstate=!0,history.back()));a.fromHistory=!1});window.addEventListener("popstate",function(b){a.disablePopstate||(a.fromHistory=!0,b.state&&b.state.lenta&&!0===b.state.lenta?a.changeState("lenta",!0):(a.changeState("lenta",!1),dataLayer.push({block:"lenta_widget",event:"lenta_close_back"})),b.state&&
b.state.chat&&!0===b.state.chat?a.changeState("chat",!0):(a.changeState("chat",!1),dataLayer.push({block:"chat_widget",event:"chat_close_back"})));a.disablePopstate=!1},!1)},headerStatesSwitching:function(){var a=$("#body"),b=$("#header").offset().top+(a.hasClass(this.mod.hBrand)?$("#headerHeight").outerHeight():0);this.headerStatesCheck(b,a.hasClass(this.mod.hSticked),this.mod.hSticked);this.headerStatesCheck(b+this.headerToSmall,a.hasClass(this.mod.hSmall),this.mod.hSmall)},headerStatesCheck:function(a,
b,d){var c=$(window).scrollTop();c>=a&&!b?$("#body").addClass(d):(0==c||c<a&&b)&&$("#body").removeClass(d)},setWidgetsSize:function(){var a="100%",b=$("#headerHeight");768<this.getClientWidth()&&$(window).scrollTop()<b.offset().top&&(a=this.getViewHeight()-b[0].getBoundingClientRect().top);this.widgetsSize!=a&&(a<this.minHeightViewWidgets&&(a=0),$("#widgetsSize").height(a),this.widgetsSize=a)},widgetsManager:function(){var a=this,b=$("body"),d=a._state;$(window).on("resize",function(){var c=a.getClientWidth();
d.lenta&&768>c&&(d.chat||d.live)&&a.changeState({chat:!1,live:!1});(d.lenta||d.live||d.chat)&&!$("#modalLayer").hasClass("m-open")&&ria.disablePageScroll(768<=c?!1:!0)});b.on("click",function(){768<=a.getClientWidth()&&a._state.lenta&&a.changeState("lenta",!1)});$("#widgetBottom").on("click",function(c){a._state.lenta&&c.stopPropagation()});$("."+a.button.live).on("click",function(c){c.stopPropagation();c.preventDefault();a._state.live?a._state.lenta?a.changeState("lenta",!1):a.changeState("live",
!1):a.changeState({lenta:!1,chat:!1,live:!0})});$("."+a.button.chat).on("click",function(c){c.stopPropagation();c.preventDefault();a._state.chat?a._state.lenta?a.changeState("lenta",!1):a.changeState("chat",!1):a.changeState({lenta:!1,chat:!0,live:!1})});$("."+a.button.lenta).on("click",function(c){c.stopPropagation();c.preventDefault();a._state.lenta?a.changeState("lenta",!1):a.changeState("lenta",!0)});$("."+a.button.all).on("click",function(c){c.stopPropagation();c.preventDefault();a.changeState({lenta:!1,
chat:!1,live:!1})})},disablePullToReload:function(a){this.isMobile&&(!0===a||this._state.lenta||this._state.chat||this._state.live)&&768>this.getClientWidth()?($("html").addClass(this.notPullToReload),this._state.notPull=!0):!1!==a&&this._state.lenta&&this._state.chat&&this._state.live||($("html").removeClass(this.notPullToReload),this._state.notPull=!1)},changeState:function(a,b){var d=this;if($.isPlainObject(a)||"string"==typeof a&&"boolean"==typeof b){var c=!1,e={};$.isPlainObject(a)?e=a:e[a]=
b;$.each(e,function(a,b){d._state[a]!=b&&d.setState(a,b);b&&(c=!0)});768>d.getClientWidth()&&ria.disablePageScroll(c)}else return!1},setState:function(a,b){if("string"==typeof a&&"boolean"==typeof b)b?(this._state[a]=!0,$("body").addClass(this.mod[a])):(this._state[a]=!1,$("body").removeClass(this.mod[a])),$("body").trigger("widget",[a,b]);else return!1},getViewWidth:function(){var a=$("#jsViewSize");return 0<a.length?parseInt(a.width()):this.getClientWidth()},getViewHeight:function(){var a=$("#jsViewSize");
return 0<a.length?parseInt(a.height()):this.getClientHeigth()},getClientWidth:function(){return Math.max(window.innerWidth||0,(document.getElementsByTagName("html")[0]||{}).clientWidth||0)},getClientHeigth:function(){return Math.max(window.innerHeight||0,(document.getElementsByTagName("html")[0]||{}).clientHeight||0)}};
