var $jscomp={scope:{},findInternal:function(b,e,d){b instanceof String&&(b=String(b));for(var h=b.length,g=0;g<h;g++){var c=b[g];if(e.call(d,c,g,b))return{i:g,v:c}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,e,d){if(d.get||d.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[e]=d.value)};
$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(b,e,d,h){if(e){d=$jscomp.global;b=b.split(".");for(h=0;h<b.length-1;h++){var g=b[h];g in d||(d[g]={});d=d[g]}b=b[b.length-1];h=d[b];e=e(h);e!=h&&null!=e&&$jscomp.defineProperty(d,b,{configurable:!0,writable:!0,value:e})}};
$jscomp.polyfill("Array.prototype.find",function(b){return b?b:function(b,d){return $jscomp.findInternal(this,b,d).v}},"es6-impl","es3");
(function(b,e,d,h){var g=function(c,a){var f="";-1!=e.location.pathname.indexOf("editorial_preview")&&(f="?preview=1");f={actions:{getlast:"/services/victorins/get-last-question/"+f,addanswer:"/services/victorins/add-answer/"+f,getresults:"/services/victorins/get-results/"+f,reset:"/services/victorins/reset/"+f}};this.el=b(c);this.container=this.el.find(".victorina__content");this.question=this.container.find(".victorina__question:last");this.blitztimer=null;this.defOptions=f;this.userOptions=a;this.options=
b.extend(!0,{},f,a);this.init()};g.prototype={init:function(){var c=this;c.article_id=c.el.data("article-id");c.victorina_id=c.el.data("victorina-id");c.el.find(".victorina__cover").length||c.resetVictorina(!1);c.el.on("click",".victorina__submit button",function(){b(this).attr("disabled","disabled");if(b(this).parent().hasClass("m-victorina-next"))c.nextQuestion(!0);else if(b(this).parent().hasClass("m-victorina-reset"))c.container.empty(),c.resetVictorina(!0);else if(b(this).parent().hasClass("m-victorina-start"))c.resetVictorina(!0);
else{var a=c.question.find("form").serializeArray();c.addAnswer(a);1558881923==c.article_id&&dataLayer.push({event:"quiz",gaEventLabel:c.question.data("num"),gaEventAction:"\u041e\u0442\u0432\u0435\u0442\u0438\u0442\u044c"})}});if(1558881923==c.article_id)c.el.on("click",".victorina__submit a",function(){dataLayer.push({event:"quiz",gaEventLabel:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b \u0432\u0438\u043a\u0442\u043e\u0440\u0438\u043d\u044b",gaEventAction:"\u0423\u0437\u043d\u0430\u0442\u044c \u0431\u043e\u043b\u044c\u0448\u0435"})})},
nextQuestion:function(c){var a=this;a.question.off("click",".victorina__answer");b.ajax({url:a.options.actions.getlast,data:{article_id:a.article_id,victorina_id:a.victorina_id,last_question_id:a.question_id,last_question_num:a.question_num},dataType:"html",type:"POST"}).done(function(f){b(f).hasClass("victorina__result")?a.getResults():(a.container.append(f),a.question=a.container.find(".victorina__question:last"),a.initQuestion(c))})},addAnswer:function(c){var a=this;c.push({name:"victorina_id",
value:a.victorina_id});c.push({name:"article_id",value:a.article_id});c.push({name:"vic_question_id",value:a.question_id});b.ajax({url:a.options.actions.addanswer,data:c,dataType:"json",type:"POST"}).done(function(b){a.showResult(b)})},getResults:function(){var c=this,a={victorina_id:c.victorina_id};"undefined"!==typeof c.article_id&&(a.article_id=c.article_id);clearInterval(c.blitztimer);b.ajax({url:c.options.actions.getresults,data:a,dataType:"html",type:"POST",success:function(a){a=c.container.append(a);
riaShare.initItems(a.find(".victorina__share"));b("html, body").animate({scrollTop:c.container.find(".victorina__step:last").offset().top-55},300)}})},showResult:function(c){var a=this.question.find(".victorina__question-header");a.find(".victorina__question-title").html(c.answer);"undefined"!==typeof c.incorrect?a.addClass("m-victorina-false"):a.addClass("m-victorina-true");this.question.find(".victorina__answers").addClass("m-victorina-answers-results");this.question.find(".victorina__answer").each(function(){b(this).find("input").attr("disabled",
"disabled");"undefined"!==typeof c["right_"+b(this).data("id")]?(b(this).addClass("m-victorina-true"),b(this).find(".victorina__answer-text").append('<div class="victorina__answer-annotation">'+c["right_"+b(this).data("id")]+"</div>")):"undefined"!==typeof c["user_"+b(this).data("id")]&&(b(this).addClass("m-victorina-false"),b(this).find(".victorina__answer-text").append('<div class="victorina__answer-annotation">'+c["user_"+b(this).data("id")]+"</div>"))});this.question.find(".victorina__submit").addClass("m-victorina-next").find("button").removeAttr("disabled").focus()},
resetVictorina:function(c){var a=this;b.ajax({url:a.options.actions.reset,type:"POST",data:{victorina_id:a.victorina_id}}).done(function(){delete a.question_id;delete a.question_num;a.el.find(".victorina__question").length?(a.question=a.container.find(".victorina__question:last"),a.initQuestion(c)):a.nextQuestion(c)})},initQuestion:function(c){var a=this;a.question_id=a.question.data("id");a.question_num=a.question.data("num");a.question.on("click",".victorina__answer",function(){a.question.find(".victorina__answer-input input:checked").length?
a.question.find("button").removeAttr("disabled"):a.question.find("button").attr("disabled","disabled")});if(a.container.attr("data-first-question")){var f=(""+a.container.attr("data-first-question")).split(",");a.container.removeAttr("data-first-question");for(var d=0;d<f.length;d++)a.question.find('.victorina__answer-input input[value="'+f[d]+'"]').attr("checked","checked");f=a.question.find("form").serializeArray();a.addAnswer(f)}0<a.el.data("blitz-time")&&a.initBlitz();c&&b("html, body").animate({scrollTop:a.container.find(".victorina__step:last").offset().top-
55},300);1558881923==a.article_id&&dataLayer.push({event:"quiz",gaEventLabel:a.question.data("num"),gaEventAction:"\u041e\u0442\u043a\u0440\u044b\u0442\u0438\u0435 \u0432\u043e\u043f\u0440\u043e\u0441\u0430"})},initBlitz:function(b){var a=this;a.question.find(".victorina__progress").append('<div class="victorina__progress-timer"></div>');if(1==a.container.find(".victorina__question").length){var c=a.el.data("blitz-time"),d,e;a.blitztimer=setInterval(function(){d=parseInt(c/60,10);e=parseInt(c%60,
10);d=10>d?"0"+d:d;e=10>e?"0"+e:e;a.container.find(".victorina__progress-timer").text(d+":"+e);0>--c&&(a.question.off("click",".victorina__answer"),a.question.find(".victorina__submit button").attr("disabled","disabled"),a.getResults())},1E3)}}};b.fn.riaVictorina=function(c){return this.each(function(){b.data(this,"riaVictorina")||b.data(this,"riaVictorina",new g(this,c))})}})(jQuery,window,document);
